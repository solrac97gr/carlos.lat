---
title: "¬øC√≥mo obtener variables de entorno en Go? (.env o env.json) üìù"
date: "14 de Julio del 2022"
published: "2022-07-14"
abstract: "Carga tus variables de entorno usando Go desde Json o Env, conoce las ventajas y desventajas üëÄ"
image: "https://firebasestorage.googleapis.com/v0/b/portfolio-18ce8.appspot.com/o/images%2F5750679.jpg?alt=media&token=7ef5bc19-8c32-48ca-bce3-1be0a3da046c"
tag: "golang, Go "
author: "Carlos Garc√≠a"
---

# ¬øC√≥mo obtener variables de entorno en Go? (.env o env.json)üìù

<small>14 Julio del 2022</small> <EditPost path="como-obtener-variables-entorno-go-env-json" />

<img
  width="100%"
  alt="golang-wallpaper "
  src="https://firebasestorage.googleapis.com/v0/b/portfolio-18ce8.appspot.com/o/images%2F5750679.jpg?alt=media&token=7ef5bc19-8c32-48ca-bce3-1be0a3da046c"
/>

Hola mundo üåé! En este art√≠culo les explicar√© c√≥mo configurar archivos de variables de entorno con Go usando dos m√©todos diferentes. Uno usando un archivo `env.json` (mi favorito) y otro usando un archivo` .env`.

## Obtener variables de entorno desde env.json en Go

Para ello crearemos una carpeta con 4 archivos, el `main.go` , `.gitignore` , `env.example.json` y `env.json`

Agregaremos a nuestro archivo `.gitignore` la siguiente l√≠nea de c√≥digo:

```
env.json
```

Esto evitar√° que nuestro archivo de variables de entorno sea publicado en el repositorio.

Ahora prepar√©moos el archivo de configuraci√≥n json, dentro del archivo `env.example.json`

```json
{
  "env": "develop",
  "app_name": "My env App",
  "database": {
    "name": "test",
    "user": "root",
    "password": "12345"
  }
}
```

Ahora que tenemos la plantilla de configuraci√≥n lista podemos copiar el contenido a nuestro `env.json` y reemplazar los valores originales.

Ya tenemos todo listo del lado de las configuraciones ahora tocar√≠a el c√≥digo en Go. Cre√°remos una carpeta üìÅ que se llame `env` y dentro de ella crearemos un archivo `env.go`, aqu√≠ crearemos nuestra estructura que recibir√° las variables del JSON (`env.json`).

```go
package env

import (
	"json"
	"log"
	"os"
)

type EnvVariables struct {
	Env      string      `json:"env"`
	AppName  string      `json:"app_name"`
	Database EnvDatabase `json:"database"`
}

type EnvDatabase struct {
	Name     string `json:"name"`
	User     string `json:"user"`
	Password string `json:"password"`
}

type EnvService struct {
	Env  EnvVariables
	Path string
}

func NewEnvService(path string) *EnvService {
	return &EnvService{
		Path: path,
	}
}

func (e *EnvService) Load() {
	configuration := EnvVariables{}
	configFile, err := os.Open(e.Path)
	if err != nil {
		log.Fatal("opening config file", err.Error())
	}

	jsonParser := json.NewDecoder(configFile)
	if err = jsonParser.Decode(&configuration); err != nil {
		log.Fatal("parsing config file", err.Error())
	}
	e.Env = configuration
}

func (e *EnvService) GetVariables() *EnvVariables {
	return e.Env
}

```

Despu√©s de tener el archivo que cargara nuestras variables de entorno a el runtime de Go vamos a conocer c√≥mo usar este m√≥dulo desde el `main.go`

```go
package main

import (
  "github.com/solrac97g/env"
  "github.com/solrac97g/server"
)

func main() {
  envService := env.NewEnvService("./env.json")
  envService.Load()

  envVar:= envService.GetVariables()

  //Ahora podr√≠amos inyectar estas variables de entorno a otros servicios
  server,err := server.NewServer(envVar)
  if err != nil {
    //Manejar el error
  }
  server.Start(8081)
}



```

Este m√©todo tiene sus ventajas por ejemplo la posibilidad de agregar validaci√≥n de los campos en el struct de EnvVariables y el auto completado donde sabemos que tenemos exactamente y de que tipo. Sin embargo tambi√©n tiene una gran desventaja dependemos de inyectar la informaci√≥n en otros servicios.

## Obtener variables de entorno desde .env en Go

Como en el anterior proceso crearemos 4 archivos de forma inicial esta vez ser√°n:

- `.env`
- `.env.example`
- `.gitignore`
- `main.go`

En primer lugar dentro del `.gitignore` agregaremos la siguiente l√≠nea de c√≥digo, para ignorar el archivo `.env`

```yaml
.env
```

Luego dentro del archivo `.env.example` crearemos nuestras variables.

```yaml
  DATABASE_NAME=test
  DATABASE_USER=root
  DATABASE_PASSWORD=12345
```

Ahora procederemos a copiar y agregar la informaci√≥n real a nuestro archivo `.env` para cargarlo hacia nuestro programa de Go.

Para este caso usaremos una librer√≠a `godotenv` que nos ayudar√° a cargar nuestras variables de entorno.

`go get github.com/joho/godotenv`

Dentro del `main.go` pondremos lo lo siguiente

```go
package main

import (
    "github.com/joho/godotenv"
    "os"
)

func main() {
 err := godotenv.Load()
 if err != nil {
     // Manejar el error
 }
 databaseName := os.Getenv("DATABASE_NAME")
}

```

Ahora podr√≠amos acceder a nuestras variables de entorno usando el paquete `os` desde cualquier parte del programa.

Este m√©todo es mucho m√°s sencillo pero creo que a largo plazo te saca m√°s del c√≥digo teniendo que revisar los nombres de tus variables en el art√≠culo `.env` y haciendo la validaci√≥n m√°s compleja.
